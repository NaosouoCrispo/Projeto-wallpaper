<!doctype html>
<html lang="pt-BR">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>Dia da Semana + Lista</title>
<style>
body {
  overflow: hidden;
  display: flex;
  flex-direction: column;
  justify-content: flex-start;
  align-items: center;
  height: 100vh;
  margin: 0;
  font-family: "Poppins","Segoe UI",Roboto,sans-serif;
  background: linear-gradient(135deg, #000, #0f0f0f);
  color: #f8fafc;
  text-align: center;
  padding-top: 20px;
}
#day {
  font-size: 8rem;
  font-weight: 700;
  letter-spacing: 3px;
  text-transform: uppercase;
  color: #fff;
  text-shadow: 0 0 20px rgba(255,255,255,0.3);
  transition: opacity 0.3s;
  cursor: none;
  margin: 0;
}
#time {
  font-size: 3rem;
  margin: 0.5rem 0 20px 0;
  color: #fff;
  cursor: none;
}
.lista-container {
  padding: 20px;
  border-radius: 12px;
  width: 300px;
  background: rgba(255,255,255,0.007);
  display: flex;
  flex-direction: column;
  align-items: center;
  gap: 10px;
  transition: height 0.3s ease;
}
ul#taskList {
  list-style: none;
  padding: 0;
  margin: 0;
  width: 100%;
  display: flex;
  flex-direction: column;
  gap: 10px;
}
li {
  display: flex;
  align-items: center;
  gap: 10px;
  font-size: 1rem;
  overflow: hidden;
  width: 100%;
  justify-content: space-between;
  transition: background-color 0.3s ease;
}
li span {
  flex-grow: 1;
  text-align: left;
}
li button {
  flex-shrink: 0;
  color: #ffffff25;
  background-color: transparent;
  padding: 2px 6px;
  font-size: 0.9rem;
  border: none;
}
li.completed span {
  text-decoration: line-through;
  opacity: 0.6;
}
input[type="text"] {
  background: none;
  text-align: center;
  width: calc(100% - 70px);
  padding: 6px 10px;
  border-radius: 6px;
  border: none;
  outline: none;
  font-size: 1rem;
  color: #fff;
}
button {
  padding: 6px 12px;
  margin-top: 10px;
  border: none;
  border-radius: 6px;
  background-color: #ffffff;
  color: #000;
  font-weight: bold;
  cursor: pointer;
  transition: opacity 0.4s ease, visibility 0.4s ease, transform 0.2s ease;
}
button.hidden {
  opacity: 0;
  visibility: hidden;
  pointer-events: none;
}
input[type="checkbox"] {
  margin-right: 10px;
  transform: scale(1.2);
  cursor: pointer;
}
@keyframes flash-red {
  0%,100% { background-color: transparent; }
  50% { background-color: red; }
}
.flash-red {
  animation: flash-red 0.5s ease-in-out;
}
@keyframes alert-blink {
  0%,100% { background-color: transparent; }
  50% { background-color: rgba(255, 0, 0, 0.3); }
}
.blink-alert {
  animation: alert-blink 1s ease-in-out 3;
}
main {
  margin-top: 10%;
  flex-shrink: 0;
}

/* Responsivo: tablets e celulares */
@media (max-width: 1000px) {
  main { margin-top: 25%; }
  #day { font-size: 6rem; }
  #time { font-size: 2.5rem; }
  .lista-container {
    width: 90%;
    padding: 15px;
  }
  li { font-size: 0.9rem; }
  input[type="text"] {
    width: calc(100% - 60px);
    font-size: 0.9rem;
  }
  button { padding: 5px 10px; font-size: 0.9rem; }
}
@media (max-width: 600px) {
  main { margin-top: 35%; }
  #day { font-size: 4rem; }
  #time { font-size: 2rem; }
  .lista-container {
    width: 95%;
  }
}
</style>
</head>
<body>
<main>
  <div id="day">----</div>
  <div id="time">--:--:--</div>
</main>
<section>
  <div class="lista-container" id="listaBox">
    <input type="text" id="newItem" placeholder="Adicionar tarefa" />
    <ul id="taskList"></ul>
    <button id="addBtn" onclick="addItem()">Adicionar</button>
  </div>
</section>
<script>
const days = ["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"];
let currentDayIndex = new Date().getDay();

function updateDay(){
  const now = new Date();
  document.getElementById("day").textContent = days[now.getDay()];
  if(now.getDay() !== currentDayIndex){
    currentDayIndex = now.getDay();
    document.querySelectorAll("#taskList input[type='checkbox']").forEach(cb=>{
      cb.checked = false;
      cb.parentElement.classList.remove('completed');
    });
    saveTasks();
  }
}
updateDay();
setInterval(updateDay, 60000);

function pad(n){ return String(n).padStart(2, '0'); }
function render(now){
  const h = pad(now.getHours()), m = pad(now.getMinutes()), s = pad(now.getSeconds());
  document.getElementById('time').textContent = `${h}:${m}:${s}`;
}
function tick(){
  const now = new Date();
  render(now);
  setTimeout(tick, 1000 - (now.getTime() % 1000));
}
tick();

const taskList = document.getElementById('taskList');
const newItem = document.getElementById('newItem');
const addButton = document.getElementById('addBtn');
const listaBox = document.getElementById('listaBox');
const MAX_ITEMS = 9;

function saveTasks() {
  const tasks = [];
  document.querySelectorAll('#taskList li').forEach(li => {
    const text = li.querySelector('span').textContent;
    const completed = li.classList.contains('completed');
    tasks.push({ text, completed });
  });
  localStorage.setItem('tasks', JSON.stringify(tasks));
}

function loadTasks() {
  const tasks = JSON.parse(localStorage.getItem('tasks')) || [];
  tasks.forEach(task => {
    const li = createTaskItem(task.text, task.completed);
    taskList.appendChild(li);
  });
  updateLayout();
}

function createTaskItem(text, completed = false) {
  const li = document.createElement('li');
  const checkbox = document.createElement('input');
  checkbox.type = 'checkbox';
  checkbox.checked = completed;

  const span = document.createElement('span');
  span.textContent = text;

  const removeBtn = document.createElement('button');
  removeBtn.textContent = 'X';
  removeBtn.onclick = () => {
    taskList.removeChild(li);
    saveTasks();
    updateLayout();
  };

  checkbox.addEventListener('change', () => {
    li.classList.toggle('completed');
    checkbox.classList.add('flash-red');
    setTimeout(() => checkbox.classList.remove('flash-red'), 500);
    saveTasks();
  });

  if (completed) li.classList.add('completed');
  li.append(checkbox, span, removeBtn);
  return li;
}

function addItem() {
  if (taskList.children.length >= MAX_ITEMS) return;

  const value = newItem.value.trim();
  if (!value) return;

  const li = createTaskItem(value);
  taskList.appendChild(li);
  newItem.value = "";
  saveTasks();
  updateLayout();
}

function updateLayout() {
  const count = taskList.children.length;
  const baseHeight = 150; // altura base mínima
  const itemHeight = 40;  // altura estimada de cada item
  listaBox.style.height = `${baseHeight + itemHeight * count}px`;

  if (count >= MAX_ITEMS) {
    addButton.classList.add('hidden');
  } else {
    addButton.classList.remove('hidden');
  }
}

newItem.addEventListener("keypress", e => {
  if (e.key === "Enter") addItem();
});

loadTasks();

/* === VERIFICAÇÃO A CADA 5 HORAS === */
function checkUncompletedTasks() {
  document.querySelectorAll('#taskList li').forEach(li => {
    const checkbox = li.querySelector('input[type="checkbox"]');
    if (!checkbox.checked) {
      li.classList.add('blink-alert');
      setTimeout(() => li.classList.remove('blink-alert'), 3000);
    }
  });
}
// 5 horas em milissegundos = 5 * 60 * 60 * 1000
setInterval(checkUncompletedTasks, 5 * 60 * 60 * 1000);
</script>
</body>
</html>
